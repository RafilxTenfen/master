sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_attacks_percentage = (number_of_attacks / sum_period_number_of_attacks) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100)
minimum_percentage_as_others = 1
decimals_digits = 1
data_grouped_period_command_others_percentage = data_grouped_period_command_percentage %>%
mutate(
command = case_when(
number_of_requests_percentage < minimum_percentage_as_others ~ "OUTROS",
TRUE ~ as.character(command)
)
) %>%
group_by(year_period, command) %>%
summarise(number_of_requests_percentage = sum(number_of_requests_percentage))
data_grouped_period_command_others_percentage %>%
print(n=16)
data_grouped_period_command_others_percentage %>%
ggplot( aes(x=command, y=number_of_requests_percentage, fill=command)) +
geom_bar(stat="identity", width = 0.5, position="dodge") +
geom_text(aes(label = paste(round(number_of_requests_percentage, decimals_digits), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE) +
theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1)) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de comandos") +
xlab("Período (Trimestre)") +
ggtitle("Comandos memcached 2020 ~ 2022")
data_grouped_period_command_others_percentage %>%
ggplot( aes(x=year_period, y=number_of_requests_percentage, fill=command)) +
geom_bar(stat="identity", width = 0.5) +
geom_text(aes(label = paste(round(number_of_requests_percentage, decimals_digits), "%")), position = position_stack(vjust = 0.1)) +
scale_fill_viridis(discrete=TRUE) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
ylab("Porcentagem da quantidade de comandos") +
xlab("Período (Trimestre)") +
ggtitle("Comandos memcached 2020 ~ 2022")
data_grouped_period_command_others_percentage %>%
ggplot( aes(x=year_period, y=number_of_requests_percentage, group=command)) +
geom_line(size=1.2, aes(color=command)) +
geom_point(color="red", size=3,  aes(color=command)) +
geom_text(
aes(label = paste(round(number_of_requests_percentage, decimals_digits), "%")),
hjust = -0.03, nudge_x = 0.05, nudge_y = -1, angle = -10,
) +
scale_fill_viridis(discrete=TRUE) +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
) +
ylab("Porcentagem da quantidade de comandos") +
xlab("Período (Trimestre)") +
ggtitle("Comandos memcached 2020 ~ 2022")
data_grouped_period_payload = data %>%
mutate(year_period = as.factor(year_period),
payload = as.factor(raw_payload)) %>%
group_by(year_period, payload) %>%
summarise(sum_requests_per_attack = sum(requests_per_attack),
number_of_payloads_by_period = n())
data_grouped_period_payload_percentage = data_grouped_period_payload %>%
ungroup() %>%
group_by(year_period) %>%
summarise(payload = payload,
number_of_payloads_by_period = number_of_payloads_by_period,
sum_number_of_payloads_by_period = sum(number_of_payloads_by_period),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_payloads_percentage = (number_of_payloads_by_period / sum_number_of_payloads_by_period) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100)
data_grouped_period_payload_others_percentage = data_grouped_period_payload_percentage %>%
mutate(
payload = case_when(
number_of_payloads_percentage < minimum_percentage_as_others ~ "OUTROS",
TRUE ~ as.character(payload)
)
) %>%
group_by(year_period, payload) %>%
summarise(
number_of_payloads_percentage = sum(number_of_payloads_percentage))
data_grouped_period_payload_others_percentage %>%
mutate(payload_limit=substr(payload, 0, 45)) %>%
ggplot( aes(x=payload_limit, y=number_of_payloads_percentage, fill=payload_limit)) +
geom_bar(stat="identity", width = 0.5, position="dodge") +
geom_text(aes(label = paste(round(number_of_payloads_percentage, decimals_digits), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE) +
theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1)) +
facet_grid(~year_period) +
ylab("Porcentagem de ataques agrupados por payload e periodo") +
xlab("Payloads") +
ggtitle("Payloads memcached 2020 ~ 2022")
data_grouped_period_payload_others_percentage %>%
mutate(payload_limit=substr(payload, 0, 80)) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_get_payload = data %>%
filter(memcached_request_type %in% c("Get")) %>%
select(year_period, requests_per_attack, quote_payload_get, raw_payload)
data_grouped_period_payload_get = data_get_payload %>%
mutate(year_period = as.factor(year_period),
payload_get = as.factor(quote_payload_get)) %>%
group_by(year_period, payload_get) %>%
summarise(sum_requests_per_attack = sum(requests_per_attack),
number_of_payloads_get_by_period = n())
data_grouped_period_payload_get_percentage = data_grouped_period_payload_get %>%
ungroup() %>%
group_by(year_period) %>%
summarise(payload_get = payload_get,
number_of_payloads_get_by_period = number_of_payloads_get_by_period,
sum_number_of_payloads_get_by_period = sum(number_of_payloads_get_by_period),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_payloads_get_percentage = (number_of_payloads_get_by_period / sum_number_of_payloads_get_by_period) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100)
data_grouped_period_payload_get_others_percentage = data_grouped_period_payload_get_percentage %>%
mutate(
payload_get = case_when(
number_of_payloads_get_percentage < minimum_percentage_as_others ~ "OUTROS",
TRUE ~ as.character(payload_get)
)
) %>%
group_by(year_period, payload_get) %>%
summarise(
number_of_payloads_get_percentage = sum(number_of_payloads_get_percentage)
)
data_grouped_period_payload_get_others_percentage %>%
mutate(payload_limit=substr(payload_get, 0, 25)) %>%
ggplot( aes(x=payload_limit, y=number_of_payloads_get_percentage, fill=payload_limit)) +
geom_bar(stat="identity", width = 0.5, position="dodge") +
geom_text(aes(label = paste(round(number_of_payloads_get_percentage, decimals_digits), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE) +
theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1)) +
facet_grid(~year_period) +
ylab("Porcentagem de payloads do tipo get agrupados por payload e periodo") +
xlab("Payloads") +
ggtitle("Get Payloads memcached 2020 ~ 2022")
data_grouped_period_payload_get_others_percentage %>%
mutate(payload_limit=substr(payload_get, 0, 60)) %>%
select(year_period, percentage=number_of_payloads_get_percentage, payload_limit) %>%
print(n=24)
data_grouped_period_payload_get_others_percentage
data
?right_join
data_grouped_period_payload_get_others_percentage
data %>%
right_join(data_grouped_period_payload_get_others_percentage, by=c("quote_payload_get", "payload_get"))
data %>%
right_join(data_grouped_period_payload_get_others_percentage, by=c("quote_payload_get" = "payload_get"))
data %>%
left_join(data_grouped_period_payload_get_others_percentage, by=c("quote_payload_get" = "payload_get"))
data_grouped_period_payload_get_others_percentage %>%
left_join(data, by=c("quote_payload_get" = "payload_get"))
data_grouped_period_payload_get_others_percentage %>%
left_join(data, by=c("payload_get" = "quote_payload_get"))
data_grouped_period_payload_get_others_percentage %>%
merge(data, by=c("payload_get" = "quote_payload_get"))
%>%
left_join(data_grouped_period_payload_get_others_percentagedata, by=c("payload_get" = "quote_payload_get"))
left_join(data_grouped_period_payload_get_others_percentage, data, by=c("payload_get" = "quote_payload_get"))
left_join(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE
)
MERGE(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE
)
merge(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE
)
inner_join(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE
)
full_join(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE
)
?merge
merge(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get")
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by=c("payload_get" = "quote_payload_get")
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by=c("payload_get")
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by="payload_get"
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by="payload_get", all=TRUE
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by="payload_get", all.x=TRUE
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by="payload_get", all.y=TRUE
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by="payload_get", all.x=TRUE
)
merge(data_grouped_period_payload_get_others_percentage, data %>% mutate(payload_get=quote_payload_get),
by="payload_get"
)
data_grouped_period_payload_get_others_percentage
full_join(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE
)
?full_join
left_join(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE
)
left_join(data_grouped_period_payload_get_others_percentage, data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE,
)
left_join(x=data_grouped_period_payload_get_others_percentage, y=data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE,
)
left_join(x=data_grouped_period_payload_get_others_percentage, y=data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE,
suffix = c(".x", ".y")
)
left_join(x=data_grouped_period_payload_get_others_percentage, y=data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE
)
left_join(x=data_grouped_period_payload_get_others_percentage, y=data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE
) %>%
group_by(year_period.x, payload_get, number_of_payloads_get_percentage, raw_payload)
left_join(x=data_grouped_period_payload_get_others_percentage, y=data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE
) %>%
count(year_period.x, payload_get, number_of_payloads_get_percentage, raw_payload)
data_grouped_period_payload_get_others_percentage_with_raw_payload = left_join(x=data_grouped_period_payload_get_others_percentage, y=data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE
) %>%
count(year_period.x, payload_get, number_of_payloads_get_percentage, raw_payload)
data_grouped_period_payload_get_others_percentage %>%
mutate(payload_limit=substr(payload_get, 0, 60)) %>%
select(year_period, percentage=number_of_payloads_get_percentage, payload_limit) %>%
print(n=24)
data_grouped_period_payload_get_others_percentage_with_raw_payload %>%
mutate(payload_limit=substr(payload_get, 0, 60)) %>%
select(year_period, percentage=number_of_payloads_get_percentage, payload_limit) %>%
print(n=24)
data_grouped_period_payload_get_others_percentage_with_raw_payload = left_join(x=data_grouped_period_payload_get_others_percentage, y=data,
by=c("payload_get" = "quote_payload_get"),
keep=FALSE,
copy = FALSE
) %>%
count(year_period.x, payload_get, number_of_payloads_get_percentage, raw_payload) %>%
select(year_period = year_period.x, payload_get,  percentage=number_of_payloads_get_percentage, raw_payload)
data_grouped_period_payload_get_others_percentage_with_raw_payload
data_grouped_period_payload_get_others_percentage_with_raw_payload %>%
mutate(payload_limit=substr(payload_get, 0, 60)) %>%
select(year_period, percentage, raw_payload) %>%
print(n=24)
data_grouped_period_payload_others_percentage %>%
mutate(payload_limit=substr(payload, 10, 80)) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(payload_limit=substr(payload, 25, 80)) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(payload_limit=substr(payload, 0, 80)) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
?replace
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=replace(payload, "b'\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "b'")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=replace(payload, "b'\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "b")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=replace(payload, "\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "b")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=stri_replace(payload, "\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace(payload, "\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
library(stringr)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace(payload, "\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace(payload, "\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
str_replace
?str_replace
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, "\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "-")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, "\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00", "-")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, "x00", "-")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, "x00", "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00"), "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
payload_replace=str_replace_all(payload, c("x00", "x01", "\"), "")
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00", "x01", "\\"), "")
payload_replace=str_replace_all(payload, c("x00", "x01", '\'), "")
payload_replace=str_replace_all(payload, c("x00", "x01", '\\\'), "")
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00", "x01"), "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00", "x01", "x00"), "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00", "x01", "\\\\"), "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00", "x01", "\\"), "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
payload_replace=str_replace_all(payload, c("x00", "x01", "\\\"), "")
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00", "x01", "\\\\"), "")
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=substr(payload, 0, 80),
payload_replace=str_replace_all(payload, c("x00", "x01"), "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=case_when(
len(payload) < 20 ~ as.character(payload),
TRUE ~ substr(payload, 20, 80)
),
payload_replace=str_replace_all(payload, c("x00", "x01"), "")
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_replace') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=case_when(
len(payload) < 20 ~ as.character(payload),
TRUE ~ substr(payload, 20, 80)
)
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=case_when(
payload == "OUTROS" ~ as.character(payload),
TRUE ~ substr(payload, 20, 80)
)
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=case_when(
payload == "OUTROS" ~ as.character(payload),
TRUE ~ substr(payload, 27, 80)
)
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=case_when(
payload == "OUTROS" ~ as.character(payload),
TRUE ~ substr(payload, 34, 80)
)
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_others_percentage %>%
mutate(
payload_limit=case_when(
payload == "OUTROS" ~ as.character(payload),
TRUE ~ substr(payload, 35, 80)
)
) %>%
select('year_period', 'percentage'='number_of_payloads_percentage', 'payload_limit') %>%
print(n=35)
data_grouped_period_payload_get_others_percentage_with_raw_payload %>%
mutate(
payload_limit=case_when(
payload == "OUTROS" ~ as.character(payload),
TRUE ~ substr(payload, 35, 80)
)
) %>%
select(year_period, percentage, raw_payload) %>%
print(n=24)
data_grouped_period_payload_get_others_percentage_with_raw_payload %>%
mutate(
payload_limit=case_when(
payload_get == "OUTROS" ~ as.character(payload_get),
TRUE ~ substr(payload_get, 35, 80)
)
) %>%
select(year_period, percentage, raw_payload) %>%
print(n=24)
data_grouped_period_payload_get_others_percentage_with_raw_payload %>%
mutate(
payload_limit=case_when(
payload_get == "OUTROS" ~ as.character(payload_get),
TRUE ~ substr(payload_get, 35, 80)
)
) %>%
select(year_period, percentage, payload_limit) %>%
print(n=24)
data_grouped_period_payload_get_others_percentage_with_raw_payload
data_grouped_period_payload_get_others_percentage_with_raw_payload %>%
mutate(
payload_limit=case_when(
payload_get == "OUTROS" ~ as.character(payload_get),
TRUE ~ substr(raw_payload, 35, 80)
)
) %>%
select(year_period, percentage, payload_limit) %>%
print(n=24)
