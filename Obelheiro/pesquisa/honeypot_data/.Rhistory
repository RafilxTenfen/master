data_unfetch <-dbSendQuery(db, "
SELECT *, CAST(CAST(year AS text) || CAST(period AS text) as integer) as year_period
FROM DNS_ANALYSIS
JOIN DNS_ANALYSIS_QUESTION
ON DNS_ANALYSIS.id = DNS_ANALYSIS_QUESTION.dns_analysis_id
WHERE QTYPE != 0
")
data <- fetch(data_unfetch)
dbDisconnect(db)
data_split_year_period = data %>%
group_split(year_period)
N=10
period_query_id = data.frame()
for (i in c(1:length(data_split_year_period))) {
query_id_frequency = data_split_year_period[[i]] %>%
count(query_id)
query_id_frequency['year_period'] = data_split_year_period[[i]]$year_period[1]
period_query_id = rbind(period_query_id, head(query_id_frequency[order(-query_id_frequency$n),], N) )
}
period_query_id %>%
group_split(year_period)
period_query_id %>%
count(query_id) %>%
arrange(desc(n)) %>%
filter(n > 1)
period_query_id_qname = data.frame()
for (i in c(1:length(data_split_year_period))) {
query_id_qname_frequency = data_split_year_period[[i]] %>%
count(qname, qtype, query_id, year_period, sort = TRUE) %>%
filter(n > 1)
period_query_id_qname = rbind(period_query_id_qname, head(query_id_qname_frequency, N) )
}
period_query_id_qname %>%
group_split(year_period)
period_query_id_qname %>%
count(query_id, qtype, qname) %>%
arrange(desc(n)) %>%
filter(n > 1)
data['tempo_final']
#data['tempo_final'] = strptime(data[['tempo_final']], format = "%Y-%m-%d %H:%M:%S")
data['tempo_final']
data[['tempo_final']]
data['tempo_final_cast'] = as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d %H:%M:%S")
data
select(data, 'query_id', 'qtype', 'qname', 'year_period', 'requests_per_attack', 'tempo_final_cast')
select
select?
s
?select
data_overlap = select(data, 'query_id', 'qtype', 'qname', 'year_period', 'requests_per_attack', 'tempo_final_cast')
data_overlap
?filter
period_query_id_qname
top_queryid_qname
top_queryid_qname = period_query_id_qname %>%
count(query_id, qtype, qname) %>%
arrange(desc(n)) %>%
filter(n > 1)
top_queryid_qname
top_queryid_qname
data_overlap
top_queryid_qname
top_queryid_qname['query_id']
top_queryid_qname[['query_id']]
data_overlap %>%
filter(query_id %in% top_queryid_qname[['query_id']])
data_overlap %>%
filter(query_id %in% top_queryid_qname[['query_id']]) %>%
filter(qname %in% top_queryid_qname[['qname']])
top_queryid_qname
top_queryid_qname %>%
count(query_id)
top_queryid_qname %>%
count(query_id) %>%
filter(n > 1)
top_queryid_qname %>%
count(query_id) %>%
filter(n > 1) %>%
select('query_id')
top_repeated_query_id[['query_id']]
top_repeated_query_id = top_queryid_qname %>%
count(query_id) %>%
filter(n > 1) %>%
select('query_id')
top_repeated_query_id[['query_id']]
data_overlap
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_queryid_qname[['qname']])
top_queryid_qname
top_queryid_qname %>%
filter(query_id %in% top_repeated_query_id[['query_id']])
top_queryid_qname %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
select('qname')
top_repeated_qname = top_queryid_qname %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
select('qname')
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']])
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']])
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
?as.POSIXct
data['tempo_final_cast']
day(data['tempo_final_cast'])
day(data[['tempo_final_cast']])
data['tempo_final_cast']
day('2020-10-29 16:16:19')
data[['tempo_final_cast']]$day
as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d")
data['tempo_final_date'] = as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d")
as.POSIXct(data[['tempo_final']], format = "%H")
library(lubridate)
library(lubridate)
ymd_hms(data['tempo_final_cast'])
ymd_hms(data[['tempo_final_cast']])
hour(ymd_hms(data[['tempo_final_cast']]))
data['tempo_final_ymd'] = ymd_hms(data[['tempo_final_cast']])
data
hour(data['tempo_final_cast'])
hour(data[['tempo_final_cast']])
date(data[['tempo_final_cast']])
data['tempo_final_date'] = date(data[['tempo_final_cast']])
data['tempo_final_hour'] = hour(data[['tempo_final_cast']])
data
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
filter(tempo_final_date == tempo_final_date)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
filter(tempo_final_date = tempo_final_date)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap = select(data, 'query_id', 'qtype', 'qname', 'year_period', 'requests_per_attack', 'tempo_final_cast', 'tempo_final_date', 'tempo_final_hour')
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(tempo_final_date, tempo_final_hour)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(tempo_final_date, tempo_final_hour, query_id)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(tempo_final_date, tempo_final_hour, query_id, qname)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour) %>%
group_split(qname)
data_overlap_split_qname = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour) %>%
group_split(qname)
data_overlap_split_qname
data_overlap_split_qname[[1]]
data_overlap_split_qname[[0]]
data_overlap_split_qname[[2]]
data_overlap_split_qname[[1]]
anti_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]])
?anti_join
semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by= "tempo_final_date,tempo_final_hour")
semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by= "tempo_final_date")
semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by= "tempo_final_date", "tempo_final_hour")
semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by=c("tempo_final_date", "tempo_final_hour"))
semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by=c("tempo_final_date", "tempo_final_hour", "query_id", "qname"))
semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by=c("tempo_final_date", "tempo_final_hour", "query_id"))
data_overlap_split_qname = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap_split_qname = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour) %>%
group_split(qname)
stopifnot(all.equal(dim(data_overlap_split_qname[[1]]), dim(data_overlap_split_qname[[2]])))
stopifnot(all.equal(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]]))
all.equal(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]])
?all_equal
?data_overlap_split_qname[[1]]
?stopifnot
comparedf(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]])
?comparedf
??comparedf
library(arsenal)
library(arsenal)
data_overlap
?duplicated
duplicated(data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast), incomparables = c("qname"))
duplicated(data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast))
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
top_overlap = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast)
duplicated(top_overlap, incomparables = "qname")
duplicated(top_overlap, incomparables = 1)
top_overlap
duplicated(top_overlap, nmax = 1)
top_overlap[duplicated(top_overlap, nmax = 1),]
top_overlap[!duplicated(top_overlap, nmax = 1),]
duplicated(top_overlap, nmax = 1),
duplicated(top_overlap, nmax = 1),
duplicated(top_overlap, nmax = 1)
top_overlap[duplicated(top_overlap, nmax = 1),]
top_overlap = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
select('query_id', 'qtype', 'qname', 'requests_per_attack', 'tempo_final_date', 'tempo_final_hour')
duplicated(top_overlap, nmax = 1)
top_overlap
top_overlap = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
select('query_id', 'qtype', 'qname', 'tempo_final_date', 'tempo_final_hour')
duplicated(top_overlap, nmax = 1)
top_overlap
top_overlap[duplicated(top_overlap, nmax = 1),]
top_overlap[!duplicated(top_overlap, nmax = 1),]
top_overlap[!duplicated(top_overlap, nmax = 5),]
top_overlap[duplicated(top_overlap, nmax = 5),]
top_overlap[duplicated(top_overlap, nmax = 4),]
top_overlap[duplicated(top_overlap, incomparables = 4),]
data['tempo_final']
data['tempo_final_cast'] = as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d %H:%M:%S")
data['tempo_final_date'] = date(data[['tempo_final_cast']])
data['tempo_final_hour'] = hour(data[['tempo_final_cast']])
data
data[['tempo_final_cast']]$day
top_overlap[duplicated(top_overlap, incomparables = TRUE),]
duplicated(top_overlap, incomparables = TRUE)
data_overlap_split_qname = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour) %>%
group_split(qname)
all_equal(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]])
?all_equal
data_overlap_split_qname[[1]]
all.equal(select(data_overlap_split_qname[[1]], 'query_id', 'tempo_final_date', 'tempo_final_hour'), select(data_overlap_split_qname[[2]], 'query_id', 'tempo_final_date', 'tempo_final_hour'))
library(diffdf)
?compare
?compare
all.equal(select(data_overlap_split_qname[[1]], 'query_id', 'tempo_final_date', 'tempo_final_hour'), select(data_overlap_split_qname[[2]], 'query_id', 'tempo_final_date', 'tempo_final_hour'), convert=TRUE)
semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by=c("tempo_final_date", "tempo_final_hour", "query_id"))
data_overlap_split_qname[[1]]
data_overlap_split_qname[[1]]['tempo_final_date']
data_overlap_split_qname[[1]][distinct('tempo_final_date'),]
data_overlap_split_qname[[1]]['tempo_final_date']
data_overlap_split_qname[[1]][['tempo_final_date']]
distinct(data_overlap_split_qname[[1]][['tempo_final_date']])
data_overlap_split_qname[[1]] %>%
distinct()
data_overlap_split_qname[[1]]
data_overlap_split_qname[[1]] %>%
distinct()
data_overlap_split_qname[[1]] %>%
distinct(tempo_final_date)
data_overlap_split_qname[[1]]
data_overlap_split_qname[[1]] %>%
filter(tempo_final_date %in% data_overlap_split_qname[[2]] %>%
distinct(tempo_final_date))
data_overlap_split_qname[[2]] %>%
distinct(tempo_final_date)
data_overlap_split_qname[[2]] %>%
distinct(tempo_final_date)['tempo_final_date']
data_overlap_split_qname[[2]] %>%
distinct(tempo_final_date).['tempo_final_date']
data_overlap_split_qname[[2]] %>%
distinct(tempo_final_date)
data_overlap_split_qname[[2]]
merge(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by=c("query_id", "tempo_final_date", "tempo_final_hour"))
?merge
merge(select(data_overlap_split_qname[[1]], 'query_id', 'tempo_final_date', 'tempo_final_hour', 'qname'), select(data_overlap_split_qname[[2]], 'query_id', 'tempo_final_date', 'tempo_final_hour', 'qname'), by=c("query_id", "tempo_final_date", "tempo_final_hour"))
data_overlap_split_qname[[1]] %>%
anti_join(data_overlap_split_qname[[2]], by="qname")
library('RSQLite')
library('ggplot2')
library(DBI)
options("scipen"=100, "digits"=4)
library(dplyr)
library(tibble)
library(viridis)
library(lubridate)
db <- dbConnect(RSQLite::SQLite(), dbname="./dnstor_statistics_dns.sqlite")
data_unfetch <-dbSendQuery(db, "
SELECT *, CAST(CAST(year AS text) || CAST(period AS text) as integer) as year_period
FROM DNS_ANALYSIS
JOIN DNS_ANALYSIS_QUESTION
ON DNS_ANALYSIS.id = DNS_ANALYSIS_QUESTION.dns_analysis_id
WHERE QTYPE != 0
")
data <- fetch(data_unfetch)
dbDisconnect(db)
data_split_year_period = data %>%
group_split(year_period)
N=10
period_query_id = data.frame()
for (i in c(1:length(data_split_year_period))) {
query_id_frequency = data_split_year_period[[i]] %>%
count(query_id)
query_id_frequency['year_period'] = data_split_year_period[[i]]$year_period[1]
period_query_id = rbind(period_query_id, head(query_id_frequency[order(-query_id_frequency$n),], N) )
}
period_query_id %>%
group_split(year_period)
period_query_id %>%
count(query_id) %>%
arrange(desc(n)) %>%
filter(n > 1)
period_query_id_qname = data.frame()
for (i in c(1:length(data_split_year_period))) {
query_id_qname_frequency = data_split_year_period[[i]] %>%
count(qname, qtype, query_id, year_period, sort = TRUE) %>%
filter(n > 1)
period_query_id_qname = rbind(period_query_id_qname, head(query_id_qname_frequency, N) )
}
period_query_id_qname %>%
group_split(year_period)
top_queryid_qname = period_query_id_qname %>%
count(query_id, qtype, qname) %>%
arrange(desc(n)) %>%
filter(n > 1)
top_queryid_qname
data['tempo_final']
data['tempo_final_cast'] = as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d %H:%M:%S")
data['tempo_final_date'] = date(data[['tempo_final_cast']])
data['tempo_final_hour'] = hour(data[['tempo_final_cast']])
data
data[['tempo_final_cast']]$day
top_overlap = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
select('query_id', 'qtype', 'qname', 'tempo_final_date', 'tempo_final_hour')
top_overlap
library('RSQLite')
library('ggplot2')
library(DBI)
options("scipen"=100, "digits"=4)
library(dplyr)
library(tibble)
library(viridis)
library(lubridate)
db <- dbConnect(RSQLite::SQLite(), dbname="./dnstor_statistics_dns.sqlite")
data_unfetch <-dbSendQuery(db, "
SELECT *, CAST(CAST(year AS text) || CAST(period AS text) as integer) as year_period
FROM DNS_ANALYSIS
JOIN DNS_ANALYSIS_QUESTION
ON DNS_ANALYSIS.id = DNS_ANALYSIS_QUESTION.dns_analysis_id
WHERE QTYPE != 0
")
data <- fetch(data_unfetch)
dbDisconnect(db)
data_split_year_period = data %>%
group_split(year_period)
N=10
period_query_id = data.frame()
for (i in c(1:length(data_split_year_period))) {
query_id_frequency = data_split_year_period[[i]] %>%
count(query_id)
query_id_frequency['year_period'] = data_split_year_period[[i]]$year_period[1]
period_query_id = rbind(period_query_id, head(query_id_frequency[order(-query_id_frequency$n),], N) )
}
period_query_id %>%
group_split(year_period)
period_query_id %>%
count(query_id) %>%
arrange(desc(n)) %>%
filter(n > 1)
period_query_id_qname = data.frame()
for (i in c(1:length(data_split_year_period))) {
query_id_qname_frequency = data_split_year_period[[i]] %>%
count(qname, qtype, query_id, year_period, sort = TRUE) %>%
filter(n > 1)
period_query_id_qname = rbind(period_query_id_qname, head(query_id_qname_frequency, N) )
}
period_query_id_qname %>%
group_split(year_period)
top_queryid_qname = period_query_id_qname %>%
count(query_id, qtype, qname) %>%
arrange(desc(n)) %>%
filter(n > 1)
top_queryid_qname
data['tempo_final']
data['tempo_final_cast'] = as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d %H:%M:%S")
data['tempo_final_date'] = date(data[['tempo_final_cast']])
data['tempo_final_hour'] = hour(data[['tempo_final_cast']])
data_overlap = select(data, 'query_id', 'qtype', 'qname', 'year_period', 'requests_per_attack', 'tempo_final_cast', 'tempo_final_date', 'tempo_final_hour')
top_repeated_query_id = top_queryid_qname %>%
count(query_id) %>%
filter(n > 1) %>%
select('query_id')
top_repeated_qname = top_queryid_qname %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
select('qname')
data_overlap_split_qname = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour) %>%
group_split(qname)
top_overlap = data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
select('query_id', 'qtype', 'qname', 'tempo_final_date', 'tempo_final_hour')
top_overlap
#all_equal(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], )
#duplicated(top_overlap, incomparables = TRUE)
#top_overlap[duplicated(top_overlap, incomparables = TRUE),]
#all.equal(select(data_overlap_split_qname[[1]], 'query_id', 'tempo_final_date', 'tempo_final_hour', 'qname'), select(data_overlap_split_qname[[2]], 'query_id', 'tempo_final_date', 'tempo_final_hour', 'qname'), convert=TRUE)
#merge(select(data_overlap_split_qname[[1]], 'query_id', 'tempo_final_date', 'tempo_final_hour', 'qname'), select(data_overlap_split_qname[[2]], 'query_id', 'tempo_final_date', 'tempo_final_hour', 'qname'), by=c("query_id", "tempo_final_date", "tempo_final_hour"))
#data_overlap_split_qname[[1]] %>%
# anti_join(data_overlap_split_qname[[2]], by="qname")
#data_overlap_split_qname[[2]] %>%
# distinct(tempo_final_date)
#distinct(data_overlap_split_qname[[1]][['tempo_final_date']])
#semi_join(data_overlap_split_qname[[1]], data_overlap_split_qname[[2]], by=c("tempo_final_date", "tempo_final_hour", "query_id"))
#top_queryid_qname %>%
#filter(query_id )
# top_queryid_qname[['query_id']]
head(top_overlap, N)
top_queryid_qname
data_overlap
top_overlap
data_overlap %>%
filter(query_id %in% top_repeated_query_id[['query_id']]) %>%
filter(qname %in% top_repeated_qname[['qname']]) %>%
arrange(tempo_final_cast) %>%
count(query_id, qname, tempo_final_date, tempo_final_hour)
