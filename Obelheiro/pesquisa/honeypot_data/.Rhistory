ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"), vjust = +0)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
?geom_text
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"))) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")), check_overlap = TRUE) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")), hjust = 0, nudge_x = 0.05) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")), hjust = 0) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")), hjust = 0, nudge_x = -0.05) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")), hjust = 0, nudge_x = -0.05) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")), hjust = 0, nudge_x = -0.05) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"))) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = +0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = +0.3)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = +0.5)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.5)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, name="") +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, name="") +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
?facet_grid
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period, margins = "vs") +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period, margins = TRUE) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period, margins = year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period, margins = "year_period") +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre") +
theme(strip.text.y = element_text(angle = 0))
data_grouped_period_ntp_type_percentage
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre por \"ntp_type\"")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
geom_bar(stat="identity", width = 0.5) +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")),
position = position_stack(vjust = 0.6)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre e por \"ntp_type\" com barras empilhadas")
knitr::opts_chunk$set(echo = TRUE)
data_grouped_period_ntp_type_percentage = data_grouped_period_ntp_type %>%
group_by(year_period) %>%
summarise(ntp_type = ntp_type, number_of_attacks = number_of_attacks,
sum_period_number_of_attacks = sum(number_of_attacks),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_attacks_percentage = (number_of_attacks / sum_period_number_of_attacks) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100)
data_grouped_period_ntp_type_percentage = data_grouped_period_ntp_type %>%
group_by(year_period) %>%
summarise(ntp_type = ntp_type, number_of_attacks = number_of_attacks,
sum_period_number_of_attacks = sum(number_of_attacks),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_attacks_percentage = (number_of_attacks / sum_period_number_of_attacks) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100))
data_grouped_period_ntp_type_percentage = data_grouped_period_ntp_type %>%
group_by(year_period) %>%
summarise(ntp_type = ntp_type, number_of_attacks = number_of_attacks,
sum_period_number_of_attacks = sum(number_of_attacks),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_attacks_percentage = (number_of_attacks / sum_period_number_of_attacks) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100)
data_grouped_period_ntp_type %>%
group_by(year_period) %>%
summarise(ntp_type = ntp_type, number_of_attacks = number_of_attacks,
sum_period_number_of_attacks = sum(number_of_attacks),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack)
data_grouped_period_ntp_type %>%
group_by(year_period) %>%
summarise(ntp_type = ntp_type, number_of_attacks = number_of_attacks,
sum_period_number_of_attacks = sum(number_of_attacks),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack)
knitr::opts_chunk$set(echo = TRUE)
library('RSQLite')
library('ggplot2')
library(DBI)
options("scipen"=100, "digits"=4)
library(dplyr)
library(tibble)
library(viridis)
library(lubridate)
db <- dbConnect(RSQLite::SQLite(), dbname="../db/database-2022-05-11/dnstor_statistics_ntp.sqlite")
data_unfetch <-dbSendQuery(db, "
SELECT *, CAST(CAST(year AS text) || CAST(period AS text) as integer) as year_period
FROM NTP_ANALYSIS
")
data <- fetch(data_unfetch)
dbDisconnect(db)
data['tempo_final_cast'] = as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d %H:%M:%S")
data['tempo_inicio_cast'] = as.POSIXct(data[['tempo_inicio']], format = "%Y-%m-%d %H:%M:%S")
data_grouped_period_ntp_type = data %>%
mutate(year_period = as.factor(year_period)) %>%
group_by(year_period, ntp_type) %>%
summarise(sum_requests_per_attack = sum(requests_per_attack), number_of_attacks = n())
data_grouped_period_ntp_type_percentage = data_grouped_period_ntp_type %>%
group_by(year_period) %>%
summarise(ntp_type = ntp_type, number_of_attacks = number_of_attacks,
sum_period_number_of_attacks = sum(number_of_attacks),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_attacks_percentage = (number_of_attacks / sum_period_number_of_attacks) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100)
data_grouped_period_ntp_type_percentage %>%
select(year_period, ntp_type, number_of_attacks_percentage, number_of_attacks) %>%
print(n=14)
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
geom_bar(stat="identity", width = 0.5) +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")),
position = position_stack(vjust = 0.6)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre e por \"ntp_type\" com barras empilhadas")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre por \"ntp_type\"")
data_grouped_period_ntp_type_percentage
data_grouped_period_ntp_type_percentage
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_requests_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_requests_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre por \"ntp_type\"")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_requests_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_requests_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de requisições") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de requisições por trimestre por \"ntp_type\"")
knitr::opts_chunk$set(echo = TRUE)
library('RSQLite')
library('ggplot2')
library(DBI)
options("scipen"=100, "digits"=4)
library(dplyr)
library(tibble)
library(viridis)
library(lubridate)
db <- dbConnect(RSQLite::SQLite(), dbname="../db/database-2022-05-11/dnstor_statistics_ntp.sqlite")
data_unfetch <-dbSendQuery(db, "
SELECT *, CAST(CAST(year AS text) || CAST(period AS text) as integer) as year_period
FROM NTP_ANALYSIS
")
data <- fetch(data_unfetch)
dbDisconnect(db)
data['tempo_final_cast'] = as.POSIXct(data[['tempo_final']], format = "%Y-%m-%d %H:%M:%S")
data['tempo_inicio_cast'] = as.POSIXct(data[['tempo_inicio']], format = "%Y-%m-%d %H:%M:%S")
data_grouped_period_ntp_type = data %>%
mutate(year_period = as.factor(year_period)) %>%
group_by(year_period, ntp_type) %>%
summarise(sum_requests_per_attack = sum(requests_per_attack), number_of_attacks = n())
data_grouped_period_ntp_type_percentage = data_grouped_period_ntp_type %>%
group_by(year_period) %>%
summarise(ntp_type = ntp_type, number_of_attacks = number_of_attacks,
sum_period_number_of_attacks = sum(number_of_attacks),
sum_period_requests_per_attack = sum(sum_requests_per_attack),
sum_requests_per_attack = sum_requests_per_attack) %>%
mutate(number_of_attacks_percentage = (number_of_attacks / sum_period_number_of_attacks) * 100,
number_of_requests_percentage = (sum_requests_per_attack / sum_period_requests_per_attack) * 100)
data_grouped_period_ntp_type_percentage %>%
select(year_period, ntp_type, number_of_attacks_percentage, number_of_attacks) %>%
print(n=14)
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=year_period, y=number_of_attacks_percentage, fill=ntp_type)) +
geom_bar(stat="identity", width = 0.5) +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%")),
position = position_stack(vjust = 0.6)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre e por \"ntp_type\" com barras empilhadas")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_attacks_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_attacks_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de ataques") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de ataques por trimestre por \"ntp_type\"")
data_grouped_period_ntp_type_percentage %>%
ggplot( aes(x=ntp_type, y=number_of_requests_percentage, fill=ntp_type)) +
#geom_bar(stat="identity", width = 0.5, prosition = "dodge") +
geom_bar(stat="identity", position="dodge") +
geom_text(aes(label = paste(round(number_of_requests_percentage, 2), "%"),  vjust = -0.25)) +
scale_fill_viridis(discrete=TRUE, option="inferno", begin = 0.8, end = 0.4, direction = -1) +
facet_grid(~year_period) +
ylab("Porcentagem da quantidade de requisições") +
xlab("Período (Trimestre)") +
ggtitle("NTP - Porcentagem de requisições por trimestre por \"ntp_type\"")
data
data
data %>%
group_by(payload)
data
data$payload
blob_to_string(data$payload)
library("dplyr.teradata")
library("dplyr.teradata")
install.packages("dplyr.teradata")
library("dplyr.teradata")
install.packages("devtools"
)
install.packages("devtools")
library("dplyr.teradata")
library("dplyr.teradata")
devtools::install_github("hoxo-m/dplyr.teradata")
library(devtools)
install.packages("devtools")
devtools::install_github("hoxo-m/dplyr.teradata")
knitr::opts_chunk$set(echo = TRUE)
library("dplyr.teradata")
data
data$payload
blob_to_string(data$payload)
rawToChar(data$payload)
rawToChar(data$payload[0])
data$payload[0]
data$payload[[0]]
data$payload[0]
data$payload[1]
rawToChar(data$payload[1])
?rawToChar
data
as.character(data$payload[1])
as.character(data$payload[2])
as.character(data$payload[2])
as.character(data$payload[3])
rawToChar(as.raw(data$payload[3]))
rawToChar(as.raw(data$payload[2]))
as.raw(data$payload[2])
data
data$payload
data$payload[4]
?blob
as.blob(c("Good morning", "Good evening"))
as.blob(c("Good morning", "Good evening"))
library(blob)
as.blob(c("Good morning", "Good evening"))
data$payload[4].
as.blob(c("Good morning", "Good evening"))
data$payload[4]
as.raw(data$payload[0])
as.raw(data$payload[2])
as.raw(data$payload[3])
as.raw(data$payload[0])
rawToChar(as.raw(data$payload[0]))
rawToChar(as.raw(data$payload[4]))
rawToChar(as.raw(data$payload[5]))
rawToChar(as.raw(data$payload[6]))
rawToChars(as.raw(data$payload[6]))
rawToBits(data$payload[6])
rawToBits(data$payload[3])
rawToBits(as.raw(data$payload[3]))
as.vector(data$payload[3])
rawToBits(as.vector(data$payload[3]))
as.vector(data$payload[3])
as.vector(data$payload[0])
as.vector(data$payload[4])
rawToChar(as.vector(data$payload[4]))
?rawToChar
str(data$payload[4])
str(data$payload[4])
str(data$payload[4])
x = str(data$payload[4])
x
data
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
