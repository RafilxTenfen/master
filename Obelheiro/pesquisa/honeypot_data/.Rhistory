group_by(qtype, year_period) %>%
summarise(quantity = sum(quantity))
dns_data_fetched.sum_attacks_quarterly = dns_data_fetched.quarter_type_quantity %>%
group_by(qtype, year_period) %>%
summarise(quantity = sum(quantity))
dns_data_fetched.sum_attacks_quarterly
dns_data_fetched.sum_attacks_quarterly[order(dns_data_fetched.sum_attacks_quarterly$year_period)]
dns_data_fetched.sum_attacks_quarterly[order(dns_data_fetched.sum_attacks_quarterly$year_period),]
dns_data_fetched.sum_attacks_quarterly[order(dns_data_fetched.sum_attacks_quarterly$quantity),]
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity),]
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity, dns_data_fetched.sum_attacks_quarterly$year_period),]
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity),]
, dns_data_fetched.sum_attacks_quarterly$year_period
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity, dns_data_fetched.sum_attacks_quarterly$year_period),]
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity, color = qtype)) +
geom_line()
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(genus))
dns_data_fetched.quarter_type_quantity
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(qtype))
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = qtype, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(year_period))
qtype
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(qtype))
dns_data_fetched.quarter_type_quantity
ggplot(data = dns_data_fetched.sum_attacks_quarterly,
mapping = aes(x = qtype, y = quantity, color = year_period)) +
geom_line() +
facet_grid(rows = vars(qtype), cols =  vars(year_period))
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(qtype))
library('RSQLite')
library('ggplot2')
library(DBI)
options("scipen"=100, "digits"=4)
db <- dbConnect(RSQLite::SQLite(), dbname="./dnstor_statistics_dns.sqlite")
dns_data <-dbSendQuery(db, "
SELECT count(*) as countGrouped, year, period, CAST(CAST(year AS text) || CAST(period AS text) as integer) as year_period , qname, qtype, SUM(count) as quantity
FROM DNS_ANALYSIS
GROUP BY year_period, year, period, qname, qtype
ORDER BY quantity DESC;
")
dns_data_fetched <- fetch(dns_data)
#dns_data_fetched
#str(dns_data_fetched)
#str(dns_data_fetched$payload)
library(dplyr)
library(tibble)
dns_data.year_period.ungrouped <- group_split(dns_data_fetched, year_period)
N = 10
dns_data.topNconsultas <- head(dns_data.year_period.ungrouped[[1]], N)
for (i in c(2:length(dns_data.year_period.ungrouped))) {
dns_data.topNconsultas <- rbind(dns_data.topNconsultas, head(dns_data.year_period.ungrouped[[i]], N))
}
#dns_data.year_period.ungrouped[[1]]
#ggplot(dns_data.year_period.ungrouped[[1]], aes(x=qname, y=quantity), ) + geom_histogram(fill="skyblue", alpha=0.5)
ggplot(data = dns_data.year_period.ungrouped[[1]], aes(x = qname, y = quantity)) +
geom_boxplot()
dns_data.topNconsultas
dns_data.year_period.ungrouped
dns_data_fetched[order(dns_data_fetched$year, dns_data_fetched$period, -dns_data_fetched$quantity),]
dns_data_fetched
# ggplot(request, aes(x=rt, fill=Type)) + geom_density(alpha=0.4) + scale_x_log10() + xlab("Number Request (log 10)") + ylab("Density") + ggtitle("Request per DRDoS Attacks")
# barplot
#  ggplot(nlme::Oxboys, aes(age, height))
# Top N consultas por período N = 10
dns_data.topNconsultas
ggplot(dns_data_fetched, aes(x=year_period), ) + geom_histogram(fill="skyblue", alpha=0.5)
ggplot(dns_data.topNconsultas, aes(qname,quantity, group = 1)) + geom_line() + facet_grid(year_period ~ .)
#ggplot(data = dns_data.topNconsultas) +
# geom_point(mapping = aes(x = year_period, y = quantity)) +
#facet_wrap(~ class, nrow = 2)
#ggplot(data = dns_data.topNconsultas) +
# geom_bar(mapping = aes(x = year_period, y = count, fill = year_period), position = "fill")
# Quantos ataques com cada tipo de qtype foi utilizado, por trimestre ?
dns_data_fetched
dns_data_fetched.quarter_type_quantity = select(dns_data_fetched, c('year_period', 'qtype', 'quantity'))
dns_data_fetched.quarter_type_quantity
typeof(dns_data_fetched$year_period)
dns_data_fetched$year_period
dns_data_fetched.quarter_type_quantity
dns_data_fetched.sum_attacks_quarterly = dns_data_fetched.quarter_type_quantity %>%
group_by(qtype, year_period) %>%
summarise(quantity = sum(quantity))
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity, dns_data_fetched.sum_attacks_quarterly$year_period),]
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity, color = qtype)) +
geom_line()
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(qtype))
#aggregate(x = dns_data_fetched.quarter_type_quantity, FUN = "sum", drop = TRUE)
# Quantos qtypes novos aprecem em cada trimestre
# Quantos qname novos aprecem em cada trimestre
as.data.frame(dns_data.year_period.ungrouped[[1]])
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity, color = qtype)) +
geom_line()
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(qtype))
dns_data.year_period.ungrouped[[1]]
group_by(dns_data.year_period.ungrouped[[1]], year_period, qtype)
summarise(dns_data.year_period.ungrouped[[1]], year_period, qtype)
summarise(dns_data.year_period.ungrouped[[1]], qtype)
summarise(dns_data.year_period.ungrouped[[1]], qtype, quantity)
summarise(dns_data.year_period.ungrouped[[1]], qtype, quantity = sum(quantity))
uantity
summarise(dns_data.year_period.ungrouped[[1]], qtype, quantity)
dns_data.year_period.ungrouped[[1]]
summarise(dns_data.year_period.ungrouped[[1]], year_period, qtype, quantity)
summarise(dns_data.year_period.ungrouped[[1]], qtype, quantity)
dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
dns_data.year_period.ungrouped <- group_split(dns_data_fetched, year_period)
N = 10
dns_data.topNconsultas <- head(dns_data.year_period.ungrouped[[1]], N)
dns_data.year_period.ungrouped.len = length(dns_data.year_period.ungrouped)
for (i in c(2:dns_data.year_period.ungrouped.len)) {
dns_data.topNconsultas <- rbind(dns_data.topNconsultas, head(dns_data.year_period.ungrouped[[i]], N))
}
# Top N consultas por período N = 10
dns_data.topNconsultas
ggplot(dns_data_fetched, aes(x=year_period), ) + geom_histogram(fill="skyblue", alpha=0.5)
ggplot(dns_data.topNconsultas, aes(qname,quantity, group = 1)) + geom_line() + facet_grid(year_period ~ .)
dns_data_fetched.quarter_type_quantity = select(dns_data_fetched, c('year_period', 'qtype', 'quantity'))
dns_data_fetched.sum_attacks_quarterly = dns_data_fetched.quarter_type_quantity %>%
group_by(qtype, year_period) %>%
summarise(quantity = sum(quantity))
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity, dns_data_fetched.sum_attacks_quarterly$year_period),]
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity, color = qtype)) +
geom_line()
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(qtype))
dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
summarise(dns_data.year_period.ungrouped[[1]], qtype, quantity)
summarise(dns_data.year_period.ungrouped[[1]], qtype, quantity)
dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype
for (i in c(2:dns_data.year_period.ungrouped.len)) {
i
}
quarter_qtype_period = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_new_qtype = df()
quarter_new_qtype = df("")
quarter_new_qtype = data.frame()
quarter_qtype = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype_2 = dns_data.year_period.ungrouped[[2]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype_2
quarter_qtype
quarter_qtype_2
quarter_qtype - quarter_qtype_2
quarter_qtype_2
merge(x = quarter_qtype, y = quarter_qtype_2, by = "qtype", all = TRUE)
?merge
merged
merged = merge(x = quarter_qtype, y = quarter_qtype_2, by = "qtype", all = TRUE)
merged
merged$quantity.x - merged$quantity.y
merged.new_quantity = merged$quantity.x - merged$quantity.y
merged.new_quantity
merged
data.frame(merged$qtype)
data.frame(merged$qtype, new_quantity=merged$quantity.y - merged$quantity.x)
quarter_qtype_2
dns_data.year_period.ungrouped[[2]]
dns_data.year_period.ungrouped[[2]][2]
dns_data.year_period.ungrouped[[2]]['year_period']
dns_data.year_period.ungrouped[[1]]['year_period'] + '->' + dns_data.year_period.ungrouped[[2]]['year_period']
paste(dns_data.year_period.ungrouped[[1]]['year_period'] , '->' , dns_data.year_period.ungrouped[[2]]['year_period'])
dns_data.year_period.ungrouped[[1]]['year_period']
dns_data.year_period.ungrouped[[1]]['year_period'][1]
head(dns_data.year_period.ungrouped[[1]]['year_period'], 1)
paste(head(dns_data.year_period.ungrouped[[1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[2]]['year_period'], 1))
quarter_qtype = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype_2
merged = merge(x = quarter_qtype, y = quarter_qtype_2, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
data.frame(merged$qtype, new_quantity=merged$quantity.y - merged$quantity.x)
data.frame(quarter_to_quarter=paste(dns_data.year_period.ungrouped[[1]]['year_period'] , '->' , dns_data.year_period.ungrouped[[2]]['year_period']), merged$qtype, new_quantity=merged$quantity.y - merged$quantity.x)
data.frame(quarter_to_quarter=paste(dns_data.year_period.ungrouped[[1]]['year_period'] , '->' , dns_data.year_period.ungrouped[[2]]['year_period']), merged$qtype, new_quantity=merged$quantity.y - merged$quantity.x)
head(
data.frame(quarter_to_quarter=paste(head(dns_data.year_period.ungrouped[[1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[2]]['year_period'], 1)), merged$qtype, new_quantity=merged$quantity.y - merged$quantity.x)
data.frame(quarter_to_quarter=paste(head(dns_data.year_period.ungrouped[[1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[2]]['year_period'], 1)), merged$qtype, new_quantity=merged$quantity.y - merged$quantity.x)
paste(head(dns_data.year_period.ungrouped[[1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[2]]['year_period'], 1))
perio_to_period = paste(head(dns_data.year_period.ungrouped[[1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[2]]['year_period'], 1))
data.frame(quarter_to_quarter=perio_to_period, merged$qtype, new_quantity=merged$quantity.y - merged$quantity.x)
data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x)
merged = merge(x = quarter_qtype, y = quarter_qtype_2, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
merged
quarter_qtype = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype_2 = dns_data.year_period.ungrouped[[2]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_new_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype, y = quarter_new_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
quarter_new_qtype <= rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype = quarter_new_qtype
}
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_new_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype, y = quarter_new_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
quarter_new_qtype <- rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype = quarter_new_qtype
}
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_new_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype, y = quarter_new_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
#perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
#quarter_new_qtype <- rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
#quarter_qtype = quarter_new_qtype
}
dns_data.year_period.ungrouped.len
dns_data.year_period.ungrouped[[dns_data.year_period.ungrouped.len]]
quarter_qtype = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_new_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
#merged = merge(x = quarter_qtype, y = quarter_new_qtype, by = "qtype", all = TRUE)
#merged.new_quantity = merged$quantity.x - merged$quantity.y
#perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
#quarter_new_qtype <- rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
#quarter_qtype = quarter_new_qtype
}
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_new_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype, y = quarter_new_qtype, by = "qtype", all = TRUE)
#merged.new_quantity = merged$quantity.x - merged$quantity.y
#perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
#quarter_new_qtype <- rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
#quarter_qtype = quarter_new_qtype
}
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_new_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype, y = quarter_new_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
#perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
#quarter_new_qtype <- rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
#quarter_qtype = quarter_new_qtype
}
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_new_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype, y = quarter_new_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
#quarter_new_qtype <- rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
#quarter_qtype = quarter_new_qtype
}
View(quarter_qtype)
View(quarter_qtype)
quarter_qtype_aux = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype_2 = dns_data.year_period.ungrouped[[2]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
quarter_qtype_2
merged = merge(x = quarter_qtype_aux, y = quarter_qtype_2, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
merged
quarter_new_qtype = data.frame()
paste(head(dns_data.year_period.ungrouped[[1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[2]]['year_period'], 1))
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
quarter_new_qtype <- rbind(data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year_period'], 1) , '->' , head(dns_data.year_period.ungrouped[[i]]['year_period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
quarter_new_qtype
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
quarter_new_qtype = data.frame()
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
quarter_qtype_aux = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
#quarter_qtype_2 = dns_data.year_period.ungrouped[[2]] %>%
#  group_by(qtype) %>%
#  summarise(quantity = sum(quantity))
#quarter_qtype_2
#merged = merge(x = quarter_qtype_aux, y = quarter_qtype_2, by = "qtype", all = TRUE)
#merged.new_quantity = merged$quantity.x - merged$quantity.y
#merged
quarter_new_qtype = data.frame()
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
quarter_qname_aux = dns_data.year_period.ungrouped[[1]] %>%
group_by(qname) %>%
summarise(quantity = sum(quantity))
quarter_new_qname = data.frame()
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qname = dns_data.year_period.ungrouped[[i]] %>%
group_by(qname) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qname_aux, y = quarter_qname, by = "qname", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qname <- rbind(quarter_new_qname, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qname_aux = quarter_qname
}
quarter_qname_aux = dns_data.year_period.ungrouped[[1]] %>%
group_by(qname) %>%
summarise(quantity = sum(quantity))
quarter_new_qname = data.frame()
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qname = dns_data.year_period.ungrouped[[i]] %>%
group_by(qname) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qname_aux, y = quarter_qname, by = "qname", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qname <- rbind(quarter_new_qname, data.frame(quarter_to_quarter=perio_to_period, merged$qname, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qname_aux = quarter_qname
}
quarter_new_qname
quarter_new_qname %>% drop_na()
delete.na(quarter_new_qname)
na.omit(quarter_new_qname)
na.omit(quarter_new_qtype)
quarter_new_qtype
dns_data_fetched.sum_attacks_quarterly = dns_data_fetched.quarter_type_quantity %>%
group_by(qtype, year_period) %>%
summarise(quantity = sum(quantity))
dns_data_fetched.quarter_type_quantity = select(dns_data_fetched, c('year_period', 'qtype', 'quantity'))
dns_data_fetched.sum_attacks_quarterly = dns_data_fetched.quarter_type_quantity %>%
group_by(qtype, year_period) %>%
summarise(quantity = sum(quantity))
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity, dns_data_fetched.sum_attacks_quarterly$year_period),]
5480221 - (610550 - 461735)
quarter_qtype_aux = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
#quarter_qtype_2 = dns_data.year_period.ungrouped[[2]] %>%
#  group_by(qtype) %>%
#  summarise(quantity = sum(quantity))
#quarter_qtype_2
#merged = merge(x = quarter_qtype_aux, y = quarter_qtype_2, by = "qtype", all = TRUE)
#merged.new_quantity = merged$quantity.x - merged$quantity.y
#merged
quarter_new_qtype = data.frame()
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
na.omit(quarter_new_qtype)
na.omit(quarter_new_qname[order(quarter_new_qname$sum_quantity)])
na.omit(quarter_new_qtype[order(quarter_new_qtype$sum_quantity)])
dns_data_fetched.quarter_type_quantity = select(dns_data_fetched, c('year_period', 'qtype', 'quantity'))
#dns_data_fetched.quarter_type_quantity
#typeof(dns_data_fetched$year_period)
#dns_data_fetched$year_period
#dns_data_fetched.quarter_type_quantity
dns_data_fetched.sum_attacks_quarterly = dns_data_fetched.quarter_type_quantity %>%
group_by(qtype, year_period) %>%
summarise(quantity = sum(quantity))
dns_data_fetched.sum_attacks_quarterly[order(-dns_data_fetched.sum_attacks_quarterly$quantity, dns_data_fetched.sum_attacks_quarterly$year_period),]
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity, color = qtype)) +
geom_line()
ggplot(data = dns_data_fetched.sum_attacks_quarterly, aes(x = year_period, y = quantity)) +
geom_line() +
facet_wrap(facets = vars(qtype))
#aggregate(x = dns_data_fetched.quarter_type_quantity, FUN = "sum", drop = TRUE)
# ------ Quantos qtypes novos aprecem em cada trimestre
quarter_qtype_aux = dns_data.year_period.ungrouped[[1]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
#quarter_qtype_2 = dns_data.year_period.ungrouped[[2]] %>%
#  group_by(qtype) %>%
#  summarise(quantity = sum(quantity))
#quarter_qtype_2
#merged = merge(x = quarter_qtype_aux, y = quarter_qtype_2, by = "qtype", all = TRUE)
#merged.new_quantity = merged$quantity.x - merged$quantity.y
#merged
quarter_new_qtype = data.frame()
for (i in c(2:dns_data.year_period.ungrouped.len)) {
quarter_qtype = dns_data.year_period.ungrouped[[i]] %>%
group_by(qtype) %>%
summarise(quantity = sum(quantity))
merged = merge(x = quarter_qtype_aux, y = quarter_qtype, by = "qtype", all = TRUE)
merged.new_quantity = merged$quantity.x - merged$quantity.y
perio_to_period = paste(head(dns_data.year_period.ungrouped[[i - 1]]['year'], 1), '.',  head(dns_data.year_period.ungrouped[[i - 1]]['period'], 1), '->' , head(dns_data.year_period.ungrouped[[i]]['year'], 1), '.', head(dns_data.year_period.ungrouped[[i]]['period'], 1))
quarter_new_qtype <- rbind(quarter_new_qtype, data.frame(quarter_to_quarter=perio_to_period, merged$qtype, sum_quantity=merged$quantity.y - merged$quantity.x))
quarter_qtype_aux = quarter_qtype
}
quarter_new_qtype
na.omit(quarter_new_qtype[order(quarter_new_qtype$sum_quantity)])
quarter_new_qtype
na.omit(quarter_new_qtype[order(quarter_new_qtype$sum_quantity)], )
na.omit(quarter_new_qtype[order(quarter_new_qtype$sum_quantity),])
na.omit(quarter_new_qname[order(quarter_new_qname$sum_quantity),])
na.omit(quarter_new_qname[order(-quarter_new_qname$sum_quantity),])
na.omit(quarter_new_qtype[order(-quarter_new_qtype$sum_quantity),])
na.omit(quarter_new_qname[order(-quarter_new_qname$sum_quantity),])
