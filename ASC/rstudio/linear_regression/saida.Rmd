---
title: "linear_regression"
output: html_document
---



- 1. A figura abaixo mostra um gráfico de dispersão que relaciona escores GPA de 15 alunos com
seu QI, com a reta de regressão correspondente.


- (a) Existe um valor atípico baixo na figura. Os valores de QI e GPA para esse aluno são:
- ii. QI = 103, GPA = 0,5

- (b) Deixando de lado o valor atípico baixo, a correlação dos 14 pontos restantes na figura é
mais próxima de
- i. 0,9

- (c) Se outro estudante tem QI de 110, você prediz para ele um GPA próximo de
- ii. 7,5

- (d) A inclinação da reta de regressão é mais próxima de
- ii. 0,2

- 2. Quais são todos os valores que uma correlação r pode assumir?
(c) −1 ≤ r ≤ 1

- 3. Se a correlação entre duas variáveis é próxima de 0, você pode concluir que um diagrama de
dispersão mostrará
- (c) nenhum padrão linear, mas poderia haver um forte padrão de outra forma

- 4. Os pontos em um diagrama de dispersão se encontram muito próximos de uma reta. A correlação entre x e y está próxima de
- (c) 1 ou −1, não podemos dizer qual

- 5. Se os homens se casassem sempre com mulheres dois anos mais novas que eles, a correlação
entre as idades de marido e mulher seria
- (a) 1

- 6. [Jain, 14.3mod] O tempo de processamento e o tamanho da memória usados por sete programas foram medidos. Os pares com tamanho da memória (em megabytes) e tempo de CPU
(em ms) observados foram { (70, 2), (75, 5), (144, 7), (190, 9), (210, 10), (235, 13), (400, 20) }. Analise os dados usando um modelo de regressão simples para prever o tempo de CPU em função
do tamanho de memória usada. Qual o tempo de CPU esperado para programas que utilizam
300 MB e 800 MB?
- 300MB 15.10448
- 800MB 40.70458

```{r}

# create dataframe
# use predict
temposCpuMemo <- c(c(70, 2), c(75, 5), c(144, 7), c(190, 9), c(210, 10), c(235, 13), c(400, 20))
temposCpuMemo

```


- 7. [Jain 1991, 14.4] Os projetistas de um sistema de informação que permite que os usuários façam
pesquisas em um histórico considerando diferentes períodos querem desenvolver uma fórmula
para prever o tempo necessário para a pesquisa. Mediu-se então o tempo gasto para diferentes
números de dias. Os valores medidos estão mostrados na tabela abaixo. Elabore um modelo
de regressão simples para esses dados que permita prever o tempo de pesquisa em função do
número de dias, e interprete os resultados.

```{r}

# create dataframe
# use predict
q7.dat = read.table('q7.dat', header = TRUE)
q7.dat

cor(q7.dat)

q7.dat.lm = lm(tpesq ~ dias, data = q7.dat)
q7.dat.lm

summary(q7.dat.lm)

confint(q7.dat.lm)
# São coeficientes significativos pois nenhum deles abrange o 0


#plot(q7.dat.lm)

```
- 8. [Jain 1991, 14.5] Em uma segunda etapa do exercício 7, o analista mediu o tempo de pesquisa
em função da complexidade da consulta. A complexidade foi mensurada pelo número de palavras chave na consulta. O número de operações de leitura de disco também foi medido, conforme mostra a tabela abaixo. Para esses dados, prepare um modelo de regressão que preveja
o tempo decorrido em função do número de palavras chave e interprete os resultados

```{r}

# create dataframe
# use predict
q8.dat = read.table('q8.dat', header = TRUE)
q8.dat

cor(q8.dat)

plot(q8.dat$palavras, q8.dat$tpesq)
q8.dat.lm = lm(tpesq ~ palavras, data = q8.dat)
q8.dat.lm

summary(q8.dat.lm)

confint(q8.dat.lm)
# São coeficientes significativos pois nenhum deles abrange o 0


#plot(q8.dat.lm)

```

- 9. Prepare um modelo de regressão para prever o número de operações de E/S em função do
número de palavras chave para os dados apresentados na tabela acima

- R: Modelo aceitavel, porém meia boca.
```{r}
#plot(q8.dat$palavras, q8.dat$nldisc)
lm9 <- lm(nldisc ~ palavras, q8.dat)
lm9

plot(q8.dat$palavras, q8.dat$nldisc, ylim=c(0, 120))
abline(lm9, col='red')

confint(lm9)
# termo independendte(Intercept) pra 95% do intervalo de confiança não passa, mas as palavras passam
confint(lm9, level=0.99)
#para 99% de confiança nenhum dos 2 passam, pois os dois intervalos contem o valor 0
```

- 10.  Uma empresa de desenvolvimento desoftwareusa um servidor de controle de versões.  Umaanalista mediu o tempo decommitnesse servidor com diferentes quantidades de usuários si-multâneos; os valores medidos estão mostrados na tabela abaixo.

```{r}
q10.dat = read.table('q10.dat', header = TRUE)
q10.dat

lm10 <- lm(tcommit ~ users + 0, q10.dat)
lm10

summary(lm10)

plot(q10.dat) # ylim=c(0, 120)
abline(lm10, col='red')

cor(q10.dat)
confint(lm10)
confint(lm10, level=0.99)
# termo independendte(Intercept) pra 95% do intervalo de confiança não passa, mas as palavras passam
#para 99% de confiança nenhum dos 2 passam, pois os dois intervalos contem o valor 0

(predicted250 = predict(lm10, newdata=data.frame(users=c(250))))

plot(lm10)
```

- (a)  Encontre um modelo de regressão para prever o tempo decommitem função do númerode usuários. Verifique se o modelo é adequado.
- R: O modelo contém o termo independente que não possui coeficiente significativo tanto para 95 e 99% no intervalo de confiança, pois possui o 0 em seu range, mas para o coeficiente de tempo para commit, é confiavel e significativo para 95 e 99% de intervalo de confiança
´
- (b)  Qual o tempo de commit predito pelo modelo para 250 usuários simultâneos?
- O tempo de commit predito para 250 usuários é `r round(predicted250, 2)` ms

- 11.  Suponha  que  medições  adicionais  no  servidor  do  exercício  10  forneçam  os  seguintes  pares(usuários,  tempo  decommit):  {  (100,  1518,6),  (200,  4006,4),  (300,  7504,6),  (400,  12004,4)  }.   Omodelo permanece válido?  Caso negativo, encontre um novo modelo que seja mais apropri-ado.

```{r}
q11.dat = data.frame(users=c(q10.dat$users, 100, 200, 300, 400), tcommit=c(q10.dat$tcommit, 1518.6, 4006.4, 7504.6, 12004.4))
q11.dat

lm11 = lm(tcommit ~ users + 0, q11.dat)
lm11

summary(lm11)
# Multiple R-squared:  0.9715 R e proximo de 1, entao ta bacana

plot(q11.dat) # ylim=c(0, 120)
abline(lm11, col='red')

cor(q10.dat)
confint(lm10)
confint(lm10, level=0.99)
```

- O modelo permanece valido para o nivel de confiança 95 e 99%, pois o intervalo de confiança dos users não contem o valor 0


- 12.  Um DBA deseja encontrar um modelo de regressão para o tempo de processamento de consul-tas em um servidor de banco de dados. Ele mediu o tempo de processamento de 10 consultas,observando também, para cada uma, o número de usuários simultâneos acessando o servidor,o tamanho da base de dados (em MB) e a utilização de CPU do servidor.   Os resultados damedição estão mostrado na tabela abaixo.  Encontre um modelo de regressão para os dadosobservados.

```{r}
q12.dat = read.table('q12.dat', header = TRUE)
q12.dat

lm12.full = lm(tempo ~ users + utilizacao + tamanho + utilizacao, q12.dat)
lm12.full

summary(lm12.full)

# Step back quant menor o AIC, melhor o modelo

lm12 = lm(tempo ~ users, q12.dat)
lm12

summary(lm12)

plot(q12.dat) # ylim=c(0, 120)
abline(lm12, col='red')

cor(q12.dat)
confint(lm12)
confint(lm12, level=0.99)
```

- 13.  Em um servidor de arquivos,  mediu-se a quantidade de memória usada com diferentes nú-meros de usuários simultâneos,  conforme a tabela abaixo.  Elabore um modelo de regressãosimples para esses dados que permita estimar o consumo de memória em função do númerode usuários, e interprete os resultados.


```{r}
q13.dat = read.table('q13.dat', header = TRUE)
q13.dat

lm13 = lm(memory ~ users, q13.dat)
lm13

summary(lm13)

plot(q13.dat) # ylim=c(0, 120)
abline(lm13, col='red')

cor(q13.dat)
confint(lm13)
confint(lm13, level=0.99)
```

- 13 R: Bom, segundo os intervalos de confiança 95 e 99%, o modelo de regressão não é confiavel, pois o intervalo de confiança de memoria em função dos usuários não é significativo pois possui o 0 em seu intervalo. Além do que o p-value é maior do que o alfa = (1 - Nivel de confiança) 

- 14.  Em um centro de processamento de alto desempenho,  é possível alocar um número fixo deprocessadores (até o limite de 128) para a execução de uma aplicação.  Mediu-se o tempo deexecução  de  uma  determinada  aplicação  com  diferentes  números  de  processadores,  com  osresultados mostrados na tabela abaixo.

- (a)  Encontre um modelo de regressão linear para o tempo de execução em função do númerode processadores, e interprete os resultados.
- R: O tempo de execução em função ao número de processadores possui um modelo de regressão linear válido, pois o intervalo de confiança para 95 e 99% são significativos pois o intervalo não contem o valor 0, além disso o p-value é menor que o alfa para ambos os casos.




```{r}
q14.dat = read.table('q14.dat', header = TRUE)
q14.dat

lm14 = lm(time ~ processors, q14.dat)
lm14

summary(lm14)

plot(q14.dat) # ylim=c(0, 120)
abline(lm14, col='red')

cor(q14.dat)
confint(lm14)
confint(lm14, level=0.99)

(predict4Processors = predict(lm14, newdata=data.frame(processors=c(4)), level = 0.9))

lm14.invert = lm(processors ~ time, q14.dat)
(predict5min = predict(lm14.invert, newdata=data.frame(time=c(300))))

#library(chemCal)

#(prediction <- inverse.predict(regres, 300)$Prediction)
```
- (b)  Qual o tempo estimado de execução da aplicação com 4 processadores?  Forneça o inter-valo de confiança de 90% para essa estimativa.
- R: O tempo estimado de execução da aplicação para 4 processadores é de: `r round(predict4Processors, 2)` s


- (c)  Estime o número de processadores necessários para que a aplicação execute em menos de5 minutos.
- R: o número de processadores necessários para que a aplicação execute em menos de 300 seg é de `r ceiling(predict5min)` processadores

- 15.  Um  desenvolvedor  web  mediu  o  tempo  médio  de  renderização  de  páginas  com  diferentesquantidades de imagens e arquivos multimídia.  Os resultados da medição, com tempos emms, estão no arquivotrender.dat.  Encontre um modelo de regressão linear para o tempo derenderização em função do número de objetos, e interprete os resultados.

```{r}
q15.dat = read.table('trender.dat', header = TRUE)
q15.dat

lm15 = lm(tempo ~ nobj, q15.dat)
lm15

summary(lm15)

plot(q15.dat) # ylim=c(0, 120)
abline(lm15, col='red')

cor(q15.dat)
confint(lm15)
confint(lm(tempo ~ nobj, q15.dat), level=0.99)

#(predict4Processors = predict(lm14, newdata=data.frame(processors=c(4)), level = \calc0.9))

#lm14.invert = lm(processors ~ time, q14.dat)
#(predict5min = predict(lm14.invert, newdata=data.frame(time=c(540))))
```

- 15 R: O modelo de regressão linear é significativo e válido, pois o p-value é menor que o alfa, para 95 e 99% de nível de confiança, além de que o intervalo de confiança é significativo para 95 e 99; O Intercept que é o termo independente não é significativo pois contém 0 então não passa.

_ Deveria ser rejeitado, devido ao cone nos residuals vs fitted graph
